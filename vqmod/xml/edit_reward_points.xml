<modification>

	<id>Edit Rewards Points</id>
	<version>300.1</version>
	<vqmver>2.6.2</vqmver>

    <file name="catalog/model/catalog/product.php">
		<operation>
            <search position="replace"><![CDATA[
            'reward'           => $query->row['reward'],
            ]]></search>
            <add><![CDATA[
            'reward'           => ($query->row['reward'] ? $query->row['reward'] : 0),            
            ]]></add>
        </operation>
    </file>>

    <file name="catalog\controller\extension\total\reward.php">
        <operation>
            <search position="replace"><![CDATA[
            $points_total += $product['points'];
            ]]></search>
            <add><![CDATA[
            $points_total += $product['total'];
            ]]></add>
        </operation>
    </file>

    <file name="catalog\model\extension\total\reward.php">
        <operation>
            <search position="replace"><![CDATA[
            $points_total += $product['points'];
            ]]></search>
            <add><![CDATA[
            $points_total += $product['total'];
            ]]></add>
        </operation>

        <operation>
            <search position="replace"><![CDATA[
            $discount = $product['total'] * ($this->session->data['reward'] / $points_total);
            ]]></search>
            <add><![CDATA[
            $discount = $this->session->data['reward'];
            ]]></add>
        </operation>
    </file>

    <file name="admin\controller\catalog\product.php">
        <operation>
            <search position="replace" offset="6"><![CDATA[
            if (isset($this->request->post['points'])) {
            ]]></search>
            <add><![CDATA[
            if (isset($this->request->post['price'])) {
                $data['points'] = $this->request->post['price'];
            } elseif (!empty($product_info)) {
                $data['points'] = $product_info['price'];
            } else {
                $data['points'] = '';
            }
            ]]></add>
        </operation>
    </file>

    <file name="admin\view\template\catalog\product_form.twig">
        <operation>
            <search position="ibefore"><![CDATA[
            type="text" name="points" value="{{ points }}" placeholder="{{ entry_points }}" id="input-points" class="form-control" />
            ]]></search>
            <add><![CDATA[
             readonly 
            ]]></add>
        </operation>
        <operation>
            <search position="replace"><![CDATA[
            <td class="text-right">{{ entry_reward }}</td>
            ]]></search>
            <add><![CDATA[
            <td class="text-right"><span data-toggle="tooltip" title="{{ help_rewards }}">{{ entry_reward }}</span></td>
            ]]></add>
        </operation>
    </file>

</modification>